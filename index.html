<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Adventures of Todd & Niki Setlist Maker</title>
    <style>
      html,
      body {
        height: 100%; /* Full viewport height */
        margin: 0; /* No margins */
        padding: 0; /* No padding */
        background-image: url("atn.png"); /* Background image */
        background-size: 300px 300px; /* Larger size for the image to reduce repeat */
        background-position: right 20% center; /* Positioning the background */
        background-repeat: repeat; /* Still allowing the image to repeat */
      }

      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }
      textarea,
      button,
      input {
        width: 90%;
        margin: 10px auto;
        display: block;
        background-color: black;
        color: white;
      }
      #searchInput {
        margin-bottom: 0; /* Reduces space below the search input */
      }
      #listsContainer {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        flex-grow: 1;
      }
      #masterList,
      #setList {
        width: 100%;
        border: 1px solid black;
        padding: 10px;
        margin: 10px 0;
        height: 400px;
        overflow-y: auto;
        background-color: white;
      }
      .song {
        margin: 5px;
        padding: 5px;
        border: 1px solid grey;
        cursor: pointer;
        background-color: white;
      }
      .song:hover {
        background-color: lightgrey;
      }
      button[onclick="copySetlist()"] {
        margin-top: -200px; /* Adjust as necessary to bring it up by approximately three lines */
      }
      @media (min-width: 480px) {
        #masterList,
        #setList {
          width: 48%; /* Two columns on smaller screens */
          margin: 10px 1%; /* Small side margins for gutter space */
        }
        #listsContainer {
          justify-content: space-around;
        }
      }
      @media (min-width: 768px) {
        #masterList,
        #setList {
          width: 45%; /* Slightly larger than on smaller devices */
        }
      }
      @media (min-width: 1024px) {
        #listsContainer {
          justify-content: space-around;
        }
      }
      @media (max-width: 480px) {
        /* Specific styles for small devices like iPhones */
        textarea,
        button,
        input {
          font-size: 14px; /* Smaller font size for better readability */
        }
        #masterList,
        #setList {
          height: 200px; /* Further reduced height for very small screens */
        }
        button {
          padding: 8px; /* Adjust padding to make buttons easier to tap */
        }
      }
    </style>
  </head>
  <body>
    <input
      id="searchInput"
      type="text"
      placeholder="Search songs..."
      oninput="filterSongs()"
    />
    <textarea id="songInput" rows="10" cols="50">
Alright now 123 bpm loop 46 
All i wanna do 120 bpm loop 43
American Boy 118 bpm loop 38
American Girl 230 bpm loop 8
as it was 174 bpm loop 80
i’m a believer 162 bpm loop 79
Bennie & the jets 72 bpm loop 9
Boots were made for walking 164 bpm loop 77
Brass in Pocket 98 bpm loop 15
BreakDown 114 bpm loop 33
Brkfst at Tifnys 112 bpm loop 24
Brown eyed girl 149 bpm loop 70
Brown eyed girl - original bpm 78 bpm loop 0
Brown eyed / i’m a believer 149 bpm loop 70
Brown eyed / i’m a believer 155 bpm loop 75
Cake by the ocean 120 bpm loop 42
Carolina 90 bpm loop 90
Crazy (patsy c) 76 bpm loop 0
Crazy (gnarls) /sweet dreams 116 bpm loop 35
Crazy little thing called love 154 bpm loop 74
Don’t know why  88 bpm loop 4
Don’t start now slower 120 bpm loop 39
Don’t start now 124 bpm loop 45
Don’t u 4get  112 bpm loop 24
Dreams 120 bpm loop 40
Espresso 104 bpm loop 24
Everywhere 108 bpm loop 27
Fade n2 u   89 bpm loop 52
Fire loop   171 bpm loop 80
Flowers/American Boy 118 bpm loop 37
Fly me to the moon 126 bpm loop 47
Footloose 174 bpm loop 80
Funk 103 bpm loop 23
Get back 123 bpm loop 46
Gimme one reason 100 bpm loop 20
Go your way 135 bpm loop 61
HardtoHandle/Butterfly(crazyTown) 104 bpm loop 24
Hotel California 74 bpm loop 2
houdini / Training season 120 bpm  loop 44
i’m a believer - original bpm 158 bpm loop 79
Jackson 130 bpm loop 59
j.t. Sad jams 77 bpm loop 99
Just like heaven 151 bpm loop 72
Killing me softly 92 bpm loop 11
Landslide 73 bpm loop 1
Levitating 103 bpm loop 22
Let’s stay together 102 bpm loop 21
Little Lies 125 bpm loop 48
Long Train 117 bpm loop 36
Love fool 112 bpm loop 24
Love Song 140 bpm loop 67
Lovely Day 98 bpm loop 17
Mary Janes last dance 86 bpm loop 16
Melt with you 156 bpm loop 71
Melt with you (atn) slower 145 bpm loop 69
Moon dance 134 bpm loop 0
Price Tag _E _ 88 bpm loop 0
Proud mary / Fire 171 bpm loop 0
Put your records on 96 bpm loop 0
Red red wine 89 bpm loop 08
Rhiannon /Bossa 129 bpm loop 53
Rock this town 200 bpm loop 84
Saw her standing there 160 bpm loop 76
Save Tonight 120 bpm loop 41
Shut up and Dance 128 bpm loop 52
Selfish 88 bpm  loop 4
Sunday morning 88 bpm loop 5
sweet dreams/Crazy (gnarls) 125 bpm loop 48
Son of a preacher man 91 bpm loop 10
Stand by me 116 bpm loop 34
Stir it up 74 bpm loop 3
style  95 bpm loop 13
Summer of 69 139 bpm loop 65
Take it easy 139 bpm loop 65
Tennessee Whiskey/Fade n2 u 89 bpm loop 52
Tiny dancer 73 bpm loop 1
Toxic acoustic 138 bpm loop 64
Training season /houdini 120 bpm loop 44
Upside down 102 bpm loop 22
Valerie 106 bpm loop 25
Valerie (slower) 103 bpm loop 19
Watermelon sugar 95 bpm loop 13
way you make me feel 114 bpm loop 30
You are the best thing 89 bpm loop 7
You may be right 151 bpm loop 73
Your Love 129 bpm loop 54
</textarea
    ><br />
    <button onclick="parseSongs()">Load Songs</button>
    <div id="listsContainer">
      <div id="masterList" tabindex="0"></div>
      <div id="setList"></div>
    </div>
    <div id="copysetList">
      <button onclick="copySetlist()">Copy Setlist</button>
    </div>
    <script>
      let originalSongs = [];
      let masterSongs = [];
      let setList = [];

      function parseSongs() {
        const input = document.getElementById("songInput").value.split("\n");
        originalSongs = input.map((line, index) => {
          const name = line.replace(/(\d+ bpm|loop \d+)/g, "").trim();
          const bpmMatch = line.match(/(\d+) bpm/);
          const bpm = bpmMatch ? parseInt(bpmMatch[1]) : null;
          const loopMatch = line.match(/loop (\d+)/);
          const loop = loopMatch ? parseInt(loopMatch[1]) : null;
          return { id: index, name, bpm, loop, originalIndex: index };
        });
        masterSongs = [...originalSongs];
        displaySongs("masterList", masterSongs);
        document.getElementById("songInput").style.display = "none";
        document.querySelector("button[onclick='parseSongs()']").style.display =
          "none";
      }

      function displaySongs(containerId, songs) {
        const container = document.getElementById(containerId);
        container.innerHTML = "";
        songs.forEach((song) => {
          const songDiv = document.createElement("div");
          songDiv.className = "song";
          songDiv.textContent = `${song.name} ${
            song.bpm ? "- " + song.bpm + " bpm" : ""
          } ${song.loop !== null ? "- loop " + song.loop : ""}`;
          songDiv.onclick = () => {
            containerId === "masterList"
              ? selectSong(song)
              : deselectSong(song);
          };
          container.appendChild(songDiv);
        });
      }

      function filterSongs() {
        const searchText = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const filteredSongs = originalSongs.filter((song) =>
          song.name.toLowerCase().includes(searchText)
        );
        displaySongs("masterList", filteredSongs);
      }

      function selectSong(song) {
        setList.push(song);
        masterSongs = masterSongs.filter((s) => s.id !== song.id);
        updateSuggestions();
        displaySongs("setList", setList);
        displaySongs("masterList", masterSongs);
      }

      function deselectSong(song) {
        masterSongs.splice(song.originalIndex, 0, song);
        setList = setList.filter((s) => s.id !== song.id);
        updateSuggestions();
        displaySongs("setList", setList);
        displaySongs("masterList", masterSongs);
      }

      function moveSongUp(song) {
        const index = setList.indexOf(song);
        if (index > 0) {
          [setList[index - 1], setList[index]] = [
            setList[index],
            setList[index - 1],
          ];
          displaySongs("setList", setList);
        }
      }

      function updateSuggestions() {
        if (!setList.length) return;
        const lastSelectedSong = setList[setList.length - 1];

        masterSongs.sort((a, b) => {
          const loopMatchA = a.loop === lastSelectedSong.loop ? 0 : 100;
          const loopMatchB = b.loop === lastSelectedSong.loop ? 0 : 100;
          const bpmDiffA = Math.abs(a.bpm - lastSelectedSong.bpm);
          const bpmDiffB = Math.abs(b.bpm - lastSelectedSong.bpm);
          const exactMatchA = loopMatchA === 0 && bpmDiffA <= 3 ? 0 : 1;
          const exactMatchB = loopMatchB === 0 && bpmDiffB <= 3 ? 0 : 1;

          return (
            exactMatchA - exactMatchB ||
            loopMatchA - loopMatchB ||
            bpmDiffA - bpmDiffB
          );
        });

        displaySongs("masterList", masterSongs);
      }

      function copySetlist() {
        const setListSongs = setList
          .map(
            (song) =>
              `${song.name} - ${song.bpm ? song.bpm + " bpm" : ""} ${
                song.loop !== null ? "- loop " + song.loop : ""
              }`
          )
          .join("\n");
        navigator.clipboard.writeText(setListSongs).then(
          () => alert("McCool-i-fied Setlist copied to clipboard!"),
          (err) => console.error("Failed to copy setlist: ", err)
        );
      }
    </script>
  </body>
</html>
